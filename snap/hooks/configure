#!/bin/sh -e

credentials_path="$(snapctl get credentials_path)"
project_id="$(snapctl get project_id)"
topic_name="$(snapctl get topic_name)"

if [ -z "$credentials_path" -o -z "$project_id" -o -z "$topic_name" ]; then
    echo "project_id and topic_name are required"
    exit 1
fi

#mkdir -m 0600 $SNAP_DATA/parameters
echo "[telemetry]" > "$SNAP_DATA/parameters.conf"
echo "credentials_path $credentials_path" >> "$SNAP_DATA/parameters.conf"
echo "project_id $project_id" >> "$SNAP_DATA/paramaters.conf"
echo "topic_name $topic_name" >> "$SNAP_DATA/parameters.conf"
